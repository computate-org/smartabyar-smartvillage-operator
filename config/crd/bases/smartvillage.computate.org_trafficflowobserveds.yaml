---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: trafficflowobserveds.smartvillage.computate.org
spec:
  group: smartvillage.computate.org
  names:
    kind: TrafficFlowObserved
    listKind: TrafficFlowObservedList
    plural: trafficflowobserveds
    singular: trafficflowobserved
  scope: Namespaced
  versions:
  - name: v1
    schema:
      openAPIV3Schema:
        description: TrafficFlowObserved is the Schema for the trafficflowobserveds API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: Spec defines the desired state of TrafficFlowObserved
            type: object
            properties:
              fiware:
                type: object
                properties:
                  service:
                    type: string
                    default: SmartTrafficLights
                    description: |
                      Describes the provided service for these devices. 
                      Use all lowercase letters. 
                      No characters with accents. 
                  service_path:
                    type: string
                    description: |
                      Fiware-ServicePath is an optional header. 
                      It is assumed that all the entities created without Fiware-ServicePath 
                      (or that don't include service path information in the database) 
                      belongs to a root scope "/" implicitely. 
                      Scope must start with "/" (only 'absolute' scopes are allowed). 
                      10 maximum scope levels in a path. 
                      50 maximum characters in each level, only alphanum and underscore allowed. 
              service_group:
                type: object
                properties:
                  cb_host:
                    type: string
                    default: http://orion-ld-fiware.apps-crc.testing
                  apikey:
                    type: string
                    default: VeberodIntersection1
                    description: |
                      Where apiKey is an alphanumerical string used to group devices logically 
                      (and for security matters) and deviceId is an ID that uniquely identifies the device. 
                      The API Key can be configured globally for an instance of the IoT Agent, 
                      or specifically for a given group of devices. 
                  resource:
                    type: string
                    default: /iot/json
              device:
                type: object
                properties:
                  transport:
                    type: string
                    default: MQTT
                    enum:
                      - MQTT
                      - AMQP
                  id:
                    type: string
                    description: |
                      A unique ID for this TrafficFlowObserved device. 
                      It can be as simple as the number 1. 
                      No characters with accents. 
                  mqtt_host:
                    type: string
                    default: fiware-broker-mqtt-0-svc.fiware.svc.cluster.local
                  mqtt_port:
                    type: number
                    default: 1883
                  mqtt_subscription_topic:
                    type: string
                    default: iot/subscribe
              iot_agent:
                type: object
                properties:
                  iot_host:
                    type: string
                    default: http://iotagent-json-north-fiware.apps-crc.testing
              smartabyar_smartvillage:
                type: object
                properties:
                  enabled:
                    type: boolean
                    default: false
                  auth_secret_name:
                    type: string
                    default: keycloak-client-secret-smartcity
                  auth_token_url:
                    type: string
                    default: https://keycloak-sso.apps-crc.testing/realms/SMARTVILLAGE/protocol/openid-connect/token
              sumo:
                type: object
                properties:
                  enabled:
                    type: boolean
                    default: false
                  avg_vehicle_per_min:
                    default: 10.00
                    type: number
                  demand_scaling_factor:
                    default: 1.00
                    type: number
                  min_green_time_sec:
                    default: 20.00
                    type: number
                  max_green_time_sec:
                    default: 30.00
                    type: number
                  queue_threshold:
                    default: 8.00
                    type: number
                  run_time:
                    type: number
                    default: 43200
                  fix_seed:
                    type: boolean
                    default: false
                  v_types:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          default: v1
                          description: The name of the vehicle type
                        accel:
                          type: number
                          default: 2.6
                          description: The acceleration ability of vehicles of this type (in m/s^2)
                        decel:
                          type: number
                          default: 4.5
                          description: The deceleration ability of vehicles of this type (in m/s^2)
                        sigma:
                          type: number
                          default: 0.5
                          description: The driver imperfection (0 denotes perfect driving)
                        length:
                          type: number
                          default: 5
                          description: The vehicle's netto-length (length) (in m)
                        min_gap:
                          type: number
                          default: 1
                          description: Empty space after leader [m]
                        max_speed:
                          type: number
                          default: 55
                          description: The vehicle's (technical) maximum velocity (in m/s)
                  routes:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          default: r1
                          description: The name of the route
                        edges:
                          type: string
                          default: "96027913#0 96027913#2 30186293 311389510#1"
                          description: The edges the vehicle shall drive along, given as their ids, separated using spaces
              attributes:
                type: array
                items:
                  type: object
                  properties:
                    object_id:
                      type: string
                    name:
                      type: string
                    type:
                      type: string
          status:
            description: Status defines the observed state of TrafficFlowObserved
            type: object
            x-kubernetes-preserve-unknown-fields: true
        type: object
    served: true
    storage: true
    subresources:
      status: {}
